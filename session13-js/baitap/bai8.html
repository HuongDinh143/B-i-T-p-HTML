<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <!-- Xây dựng một ứng dụng cho phép người dùng nhập các lựa chọn sau:

    Nếu chọn 1: Thực hiện chức năng đăng ký tài khoản, 
    đối tượng user thêm vào gồm các thông tin sau: id, user_name, email, password. 
    Thực hiện validate dữ liệu: tên không được để trống, email phải đúng định dạng, 
    mật khẩu phải dài tối thiểu 8 ký tự, email nhập vào không được phép trùng với 
    email đã tồn tại trong mảng. Nếu các giá trị thêm vào thỏa mãn thì tiến hành thêm 
    dữ liệu vào trong mảng

    Nếu chọn 2: Thực hiện chức năng đăng nhập. 
    Cho phép người dùng nhập vào email và password. 
    Nếu email và password không khớp với thông tin của các user trong mảng thì thông báo 
    “Đăng nhập thất bại” và yêu cầu người dùng nhập lại. Nếu email và password 
    khớp với dữ liệu trong mảng thì thông báo “Đăng nhập thành công” và hiển thị thông tin 
    của tài khoản vừa đăng nhập thành công ra ngoài màn hình

    Nếu chọn 3: Thoát chương trình
     -->
    <script>
        let input = prompt(`Mời bạn lựa chọn 
        a: đăng ký tài khoản
        b: đăng nhập
        c: thoát chương trình`)
        let user = [];
        class User {
            constructor(id, user_name, email, password) {
                this.id = id;
                this.user_name = user_name;
                this.email = email;
                this.password = password;
            }
        }
        if (input == "a") {
            alert("Mời bạn thiết lập account");
            let id = prompt("id của bạn: ");

            function checkUserName() {
                let user_name = prompt("user_name (tối thiếu 3 ký tự)");
                if (user_name.length !== "") {
                    alert("user_name hợp lệ");
                    return user_name;
                } else {
                    alert(`
                user_name không hợp lệ
                user_name không được để trống`);
                    return checkUserName()
                }
            }
            let user_name = checkUserName();

            function checkEmail() {
                let email = prompt("email");
                if (email.slice(-10) == "@gmail.com" && user.email !== email) {
                    alert("email hợp lệ");
                    return email;
                } else {
                    alert(`
                Email không hợp lệ
                Email phải đúng định dạng
                `);
                    return checkEmail();
                }
            }
            let email = checkEmail();

            function checkPassword() {
                let password = prompt("password (Mật khẩu tối thiểu 8 ký tự)");
                if (password.length >= 8) {
                    alert("password hợp lệ, bạn đăng ký tài khoản thành công");
                    return password;
                } else {
                    alert(`password không hợp lệ (tối thiểu 8 ký tự)`);
                    return checkPassword();
                }
            }
            let password = checkPassword();
            user.push(new User(id, user_name, email, password))
            console.log(user);

        } else if (input == "b") {
            // ví dụ
            user.push(new User(111, "dinhthuhuong", "dinhthuhuong143@gmail.com", "dinhthuhuong143"));

            function logIn(user) {
                let email = prompt("Mời bạn nhập vào email");
                let password = prompt("Mời bạn nhập password");

                for (let i = 0; i < user.length; i++) {
                    if (email == user[i].email && password == user[i].password) {
                        return alert(`Đăng nhập thành công! ID: ${user[i].id}, Tên người dùng: ${user[i].name}`);
                    }
                }

                alert("Email hoặc mật khẩu không đúng, mời bạn nhập lại");
                return logIn(user);
            }

            console.log(logIn(user));


    </script>
</body>

</html>